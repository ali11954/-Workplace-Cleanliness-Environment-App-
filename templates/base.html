<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}النظام{% endblock %}</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    /* 🎨 الهيدر */
    .custom-header {
      background: linear-gradient(90deg, #198754, #ffffff);
      padding: 4px 15px;
    }
    .company-logo {
      height: 26px;
      width: auto;
    }
    .company-name {
      font-size: 15px;
      font-weight: bold;
      color: #198754;
    }

    /* 🆕 شارة الشركة في الهيدر */
    .company-badge {
      background: linear-gradient(45deg, #007bff, #0056b3);
      color: white;
      padding: 4px 12px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
      margin-right: 10px;
      box-shadow: 0 2px 8px rgba(0,123,255,0.3);
    }

    /* 🎨 معلومات المستخدم وأزرار التحكم */
    .user-info {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      font-weight: 500;
      color: #198754;
      background: #fff;
      padding: 4px 10px;
      border-radius: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .user-info i {
      color: #198754;
    }
    .user-info .btn {
      padding: 4px 10px;
      font-size: 13px;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    .user-info .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .btn-home {
      background: linear-gradient(45deg, #198754, #20c997);
      color: #fff;
    }
    .btn-home:hover {
      background: linear-gradient(45deg, #145c32, #20c997);
      color: #fff;
    }
    .btn-back {
      background: linear-gradient(45deg, #6c757d, #343a40);
      color: #fff;
    }
    .btn-back:hover {
      background: linear-gradient(45deg, #495057, #212529);
      color: #fff;
    }
    .btn-logout {
      background: linear-gradient(45deg, #dc3545, #e63946);
      color: #fff;
    }
    .btn-logout:hover {
      background: linear-gradient(45deg, #b02a37, #c92a2a);
      color: #fff;
    }

    /* 🎨 الفوتر */
    .custom-footer {
      background: linear-gradient(90deg, #ffffff, #198754);
      color: #198754;
      font-size: 13px;
      position: fixed;
      bottom: 0;
      width: 100%;
      padding: 4px 0;
    }
    .designer {
      color: #198754;
    }
  </style>

  {% block styles %}{% endblock %}
</head>
<body>

<!-- ✅ الهيدر -->
<nav class="navbar navbar-expand-lg navbar-dark custom-header">
  <div class="container-fluid d-flex align-items-center justify-content-between">

    <!-- شعار الشركة -->
    <div class="d-flex align-items-center">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="شعار الشركة" class="company-logo me-2">
        <span class="company-name">الشركة اليمنية لتكرير السكر</span>
      </a>

      <!-- 🆕 اسم شركة المستخدم -->
      {% if current_user.is_authenticated and current_user.company %}
      <div class="company-badge">
        <i class="fas fa-building me-1"></i>
        {{ current_user.company.name }}
      </div>
      {% elif current_user.is_authenticated %}
      <div class="company-badge" style="background: linear-gradient(45deg, #6c757d, #495057);">
        <i class="fas fa-building me-1"></i>
        غير محدد
      </div>
      {% endif %}
    </div>

    <!-- معلومات المستخدم وأزرار التحكم -->
    <div class="d-flex align-items-center">
      <div class="user-info">
        <i class="fas fa-user-circle"></i>
        {{ current_user.fullname }}

        <!-- أيقونة تعليمات -->
        <button class="btn btn-sm" onclick="toggleHelp()" title="التعليمات">
          <i class="fas fa-question-circle text-warning"></i>
        </button>

        <!-- أيقونة معلومات التطبيق -->
        <button class="btn btn-sm" onclick="toggleAppInfo()" title="معلومات التطبيق">
          <i class="fas fa-info-circle text-primary"></i>
        </button>

        <!-- زر الصفحة الرئيسية -->
        <a href="{% if current_user.role == 'admin' %}{{ url_for('dashboard') }}{% else %}{{ url_for('user_dashboard') }}{% endif %}" class="btn btn-home btn-sm">
          <i class="fas fa-home"></i>
        </a>

        <!-- زر رجوع -->
        <a href="javascript:history.back()" class="btn btn-back btn-sm">
          <i class="fas fa-arrow-right"></i>
        </a>

        <!-- زر تسجيل خروج -->
        <a href="{{ url_for('logout') }}" class="btn btn-logout btn-sm">
          <i class="fas fa-sign-out-alt"></i>
        </a>
      </div>
    </div>
  </div>
</nav>

  <!-- ✅ المحتوى -->
  <main class="container my-4">
    {% block content %}{% endblock %}
  </main>

  <!-- ✅ الفوتر -->
  <footer class="custom-footer text-center">
    <div class="designer">
      تصميم البرنامج / <strong>م. علي مبارك</strong>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // وظائف التعليمات ومعلومات التطبيق
    function toggleHelp() {
      alert('مرحباً بك! للاستفسارات تواصل مع الدعم الفني.');
    }

    function toggleAppInfo() {
      alert('نظام تقييم بيئة العمل والنظافة\nالإصدار: 1.0.0');
    }
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>